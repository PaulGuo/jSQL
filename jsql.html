<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title></title>
	<script type="text/javascript" src="jsql.js"></script>
	<script type="text/javascript" src="https://raw.github.com/PaulGuo/Juicer/master/juicer.js"></script>
</head>
<body>
	<script type="text/javascript">
		var db=new jSQL();
		db.create('test',{
			'233970CA18511':{
				data:{
					adultPrice: 51,
					adultTax: "",
					airLineCode: "CA",
					airLineName: "中国国际航空公司",
					airSupplyID: 1431,
					airSupplyName: "guojizhuguan",
					airSupplyWangWang: "tbtest1111",
					allPrice: "51,0",
					arrAirPortCode: "TPE",
					arrAirPortName: "台北桃园机场",
					arrCityCode: "TPE",
					arrCityName: "台北(台湾)",
					arrDate: "11:45",
					arrDay: "2012-06-23",
					arrTime: "2012-06-23 11:45",
					backFareItemId: 233971,
					backTripType: "11",
					cabinList: "Y",
					cabinName: "Y",
					cabinNumber: 9,
					cacheID: 217159,
					cacheIDList: 217159,
					childPrice: 0,
					childTax: "",
					depAirPortCode: "PEK",
					depAirPortName: "北京首都",
					depCityCode: "BJS",
					depCityName: "北京",
					depDate: "08:35",
					depDay: "2012-06-23",
					depTime: "2012-06-23 08:35",
					disArrDay: 1,
					disDepDay: 1,
					fareID: 1000548,
					fareIDList: 1000548,
					fareItemID: 233970,
					fareItemIDList: "233970;233971",
					flightNumList: "CA185",
					flightNumber: "CA185",
					flightType: "333",
					groupFareFlag: 0,
					id: "233970CA18511",
					isArrNextDay: 0,
					isBack: 0,
					isBackTrans: true,
					isDepNextDay: 0,
					isDouble: true,
					isJoint: false,
					isOld: false,
					isReserve: 0,
					isShowTax: 0,
					isTrans: false,
					oToken: undefined,
					passangerType: "普通",
					passangerTypeIn: 1,
					recordFareId: 1000548,
					recordFareItemId: 233970,
					shortName: "国航",
					transMore: false,
					tripType: "10;11"
				},
				html: '<div class="item J_onePlane clearfix  " data-id="233970CA18511"><span class="check J_mark" title="点击这里标记候选"></span><span class="check-anim">已标记</span><table><tr><td class="company"><span class="ie-flag ie-CA">中国国际航空公司<br/><b> CA185</b><span class="gray">(机型<a href="javascript:void(0)" class="link J_PlaneType">333</a>)</span></span></td><td class="time"><b>08:35 </b><span class="gray">11:45 </span></td><td class="port">北京首都<br/>台北桃园机场</td><td class="wprice price"><div class="price-area J_priceArea">&yen;<em class="b">51</em>起</div></td><td class="operate"><a  href="javascript:;" class="operate-btn choose J_choose" data-airsupplyid="1431"><em>选择</em></a><span class="choose-description">返程为<strong>中转</strong></span></td></tr></table></div>'
			},
			'233970CA18911':{
				data:{
					adultPrice: 51,
					adultTax: "",
					airLineCode: "CA",
					airLineName: "中国国际航空公司",
					airSupplyID: 1431,
					airSupplyName: "guojizhuguan",
					airSupplyWangWang: "tbtest1111",
					allPrice: "51,0",
					arrAirPortCode: "TPE",
					arrAirPortName: "台北桃园机场",
					arrCityCode: "TPE",
					arrCityName: "台北(台湾)",
					arrDate: "17:10",
					arrDay: "2012-06-23",
					arrTime: "2012-06-23 17:10",
					backFareItemId: 233971,
					backTripType: "11",
					cabinList: "Y",
					cabinName: "Y",
					cabinNumber: 9,
					cacheID: 217157,
					cacheIDList: 217157,
					childPrice: 0,
					childTax: "",
					depAirPortCode: "PEK",
					depAirPortName: "北京首都",
					depCityCode: "BJS",
					depCityName: "北京",
					depDate: "14:05",
					depDay: "2012-06-23",
					depTime: "2012-06-23 14:05",
					disArrDay: 1,
					disDepDay: 1,
					fareID: 1000548,
					fareIDList: 1000548,
					fareItemID: 233970,
					fareItemIDList: "233970;233971",
					flightNumList: "CA189",
					flightNumber: "CA189",
					flightType: "772",
					groupFareFlag: 0,
					id: "233970CA18911",
					isArrNextDay: 0,
					isBack: 0,
					isBackTrans: true,
					isDepNextDay: 0,
					isDouble: true,
					isJoint: false,
					isOld: false,
					isReserve: 0,
					isShowTax: 0,
					isTrans: false,
					oToken: undefined,
					passangerType: "普通",
					passangerTypeIn: 1,
					recordFareId: 1000548,
					recordFareItemId: 233970,
					shortName: "国航",
					transMore: false,
					tripType: "10;11"
				},
				html:'<div class="item J_onePlane clearfix  " data-id="233970CA18911"><span class="check J_mark" title="点击这里标记候选"></span><span class="check-anim">已标记</span><table><tr><td class="company"><span class="ie-flag ie-CA">中国国际航空公司<br/><b> CA189</b><span class="gray">(机型<a href="javascript:void(0)" class="link J_PlaneType">772</a>)</span></span></td><td class="time"><b>14:05 </b><span class="gray">17:10 </span></td><td class="port">北京首都<br/>台北桃园机场</td><td class="wprice price"><div class="price-area J_priceArea">&yen;<em class="b">51</em>起</div></td><td class="operate"><a  href="javascript:;" class="operate-btn choose J_choose" data-airsupplyid="1431"><em>选择</em></a><span class="choose-description">返程为<strong>中转</strong></span></td></tr></table></div>'
			}
		}).use('test');
		
		var buildDate = function(dateString, inc) {
			var ymd = dateString.split(' ')[0].split('-');
			var time = dateString.split(' ')[1].split(':');
			if(inc) ymd[2]++;
			return new Date(ymd[0],ymd[1]-1,ymd[2],time[0],time[1]);
		};
		
		var data = db.select('*').orderby('data.depTime', buildDate , 'asc').findAll();

		var tpl = [
			'{@each data as item,index}',
				'(${index}) / ${item.__jSQL_Key} <br/>',
			'{@/each}'
		].join('');

		//console.log(db._objectToArray(data));

		document.write(juicer(tpl,{data:db._objectToArray(data)}));
		console.log(db.select('data').orderby('depTime', buildDate , 'asc').count());
		console.log(db.select('data').orderby('depTime', buildDate , 'asc').findAll());
		
		//console.log(db.select('data').orderby('depTime', buildDate , 'asc').findAll());
		//console.log(db.select('data').orderby('cacheID', 'asc').findAll());
		
		db.create('struct',{
			"first" : {
				steps : [{
					"id" : "1089",
					"name" : "日本"
				}, {
					"id" : "1111",
					"name" : "韩国"
				}, {
					"id" : "1133",
					"name" : "泰国"
				}]
			},
			"second" : {
				steps : [{
					"id" : "1904",
					"name" : "西班牙"
				}, {
					"id" : "1882",
					"name" : "瑞士"
				}, {
					"id" : "1860",
					"name" : "意大利"
				}]
			},
			"third" : {
				steps : [{
					"id" : "1904",
					"name" : "西班牙"
				}, {
					"id" : "1882",
					"name" : "瑞士"
				}, {
					"id" : "1860",
					"name" : "意大利"
				}]
			}
		}).use('struct');
		console.log(db.select('steps').orderby('cacheID', 'asc').findAll());
		console.log(db.select('steps').orderby('cacheID', 'asc').find('second'));
		console.log(db.use('struct').select('*').count());
	</script>
</body>
</html>
